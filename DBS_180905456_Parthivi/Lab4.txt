Lab 4

select count(id),course_id from takes group by course_id;

select dept_name, count(id) from student group by dept_name having count(id)>10;

select dept_name,count(course_id) from course group by dept_name;

select dept_name,avg(salary) from instructor group by dept_name having avg(salary)>42000;

select sec_id,count(id) from takes where semester='Spring' and year=2009 group by sec_id;

select course_id from prereq order by course_id asc;

select * from instructor order by salary desc;

select max(tot_sal) from (select sum(salary) as tot_sal from instructor group by dept_name);
or
select max(sum(salary)) from instructor group by dept_name;

select dept_name, avg_salary from (select dept_name,avg(salary) as avg_salary from instructor group by dept_name) where avg_salary>42000;

with enrol(sec,num) as (select sec_id, count(distinct id) from takes where semester='Spring' and year=2010 group by sec_id) select sec,num from enrol where num in (select max(num) from enrol);



select dept_name,csum,avg_sal from (select dept_name,count(*) as csum, avg(salary) as avg_sal from instructor group by dept_name) where csum>5 and avg_sal>50000;
or
select dept_name,count(*), avg(salary) from instructor group by dept_name having count(*)>5 and avg(salary)>50000;